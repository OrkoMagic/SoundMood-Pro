<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoundMood Pro v2</title>
    
    <!-- SEO -->
    <meta name="description" content="Βρείτε την τέλεια playlist για κάθε διάθεση!">
    <meta name="keywords" content="μουσική, διάθεση, spotify, playlist">
    <meta name="author" content="Costas Chatzisalis">
    <meta name="robots" content="index,follow">
    <meta name="google-site-verification" content="XXXXXXXXXXXXX_YOUR_CODE_XXXXXXXXXXX">
    
    <!-- Social Media -->
    <meta property="og:title" content="SoundMood Pro v2">
    <meta property="og:description" content="Βρείτε την τέλεια playlist για κάθε διάθεση!">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://yourdomain.com/images/social-preview.jpg">
    <meta property="og:url" content="https://yourdomain.com">
    <meta name="twitter:card" content="summary_large_image">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #2A2F4F;
            --secondary-color: #4E4FEB;
            --accent-color: #FFD700;
            --background-dark: #1A1A2E;
            --text-light: #F5F5F5;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: var(--background-dark);
            color: var(--text-light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            background-size: 400% 400%;
            animation: gradientFlow 15s ease infinite;
            z-index: -1;
            opacity: 0.1;
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .logo {
            position: fixed;
            top: 12px;
            left: 12px;
            z-index: 1000;
        }

        .logo img {
            width: 200px;
            height: auto;
            filter: drop-shadow(0 0 5px rgba(255,215,0,0.5));
        }

        .language-toggle {
            position: fixed;
            top: 18px;
            right: 12px;
            z-index: 1000;
            background: rgba(255,255,255,0.1);
            padding: 3px 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.3s;
            font-size: 0.8em;
            backdrop-filter: blur(5px);
        }

        .container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            padding: 12px;
            flex-grow: 1;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 0.8rem;
            border-radius: 12px;
            margin: 50px 0 15px;
            text-align: center;
            font-size: 0.95em;
            position: relative;
            overflow: hidden;
        }

        .mood-question {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.1em;
            color: var(--accent-color);
        }

        .mood-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .mood-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 10px;
            padding: 12px;
            color: var(--text-light);
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            min-height: 60px;
            backdrop-filter: blur(5px);
            position: relative;
        }

        .mood-btn:active {
            transform: scale(0.95);
            background: var(--secondary-color);
        }

        .mood-btn i {
            font-size: 1.5em;
            margin-bottom: 5px;
            transition: transform 0.3s ease;
        }

        .mood-btn:hover i {
            transform: rotate(15deg);
        }

        .input-area {
            margin: 15px 0;
        }

        .input-box {
            display: flex;
            gap: 8px;
        }

        .genre-input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.05);
            color: var(--text-light);
            font-size: 0.9em;
            backdrop-filter: blur(5px);
        }

        .send-btn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            background: var(--secondary-color);
            color: white;
            cursor: pointer;
            font-size: 0.9em;
            transition: transform 0.2s ease;
        }

        .playlist-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
            animation: slideIn 0.3s ease;
            backdrop-filter: blur(5px);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .social-share {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            justify-content: center;
        }

        .social-icon {
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.3s ease;
            color: var(--accent-color);
        }

        .social-icon:hover {
            transform: scale(1.2);
        }

        .footer-note {
            font-size: 0.7em;
            line-height: 1.4;
            margin-top: 10px;
            text-align: center;
            padding: 20px;
            color: #888;
        }

        .disclaimer {
            font-size: 0.6em;
            color: #666;
            text-align: center;
            margin-top: 15px;
            padding: 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        @media (max-width: 600px) {
            .mood-grid {
                grid-template-columns: 1fr;
                max-width: 300px;
                margin: 0 auto;
            }
            .logo img {
                width: 150px;
            }
        }
    </style>
</head>
<body>
    <div class="animated-bg"></div>
    
    <div class="logo">
        <img src="./images/logo.png" alt="SoundMood Pro">
    </div>

    <div class="language-toggle" onclick="toggleLanguage()" data-en="EN/GR" data-el="GR/EN">EN/GR</div>

    <div class="container">
        <div class="header">
            <span data-en="SoundMood Pro" data-el="SoundMood Pro">SoundMood Pro</span>
        </div>
        
        <div class="mood-question" data-en="What's your mood?" data-el="Ποιά είναι η διάθεσή σου;"></div>

        <div class="mood-grid">
            <button class="mood-btn" onclick="selectMood('love')" data-en="Love" data-el="Αγάπη">
                <i class="fas fa-heart"></i>
                <span>Αγάπη</span>
            </button>
            <button class="mood-btn" onclick="selectMood('happy')" data-en="Happy" data-el="Χαρά">
                <i class="fas fa-laugh-beam"></i>
                <span>Χαρά</span>
            </button>
            <button class="mood-btn" onclick="selectMood('sad')" data-en="Sad" data-el="Λύπη">
                <i class="fas fa-sad-tear"></i>
                <span>Λύπη</span>
            </button>
            <button class="mood-btn" onclick="selectMood('chill')" data-en="Chill" data-el="Χαλαρά">
                <i class="fas fa-moon"></i>
                <span>Χαλαρά</span>
            </button>
            <button class="mood-btn" onclick="selectMood('party')" data-en="Party" data-el="Πάρτι">
                <i class="fas fa-glass-cheers"></i>
                <span>Πάρτι</span>
            </button>
            <button class="mood-btn" onclick="selectMood('rainy')" data-en="Rainy Days" data-el="Βροχερές Μέρες">
                <i class="fas fa-cloud-rain"></i>
                <span>Βροχερές Μέρες</span>
            </button>
            <button class="mood-btn" onclick="selectMood('workout')" data-en="Workout" data-el="Γυμναστική">
                <i class="fas fa-dumbbell"></i>
                <span>Γυμναστική</span>
            </button>
            <button class="mood-btn" onclick="selectMood('nostalgic')" data-en="Nostalgic" data-el="Νοσταλγία">
                <i class="fas fa-history"></i>
                <span>Νοσταλγία</span>
            </button>
            <button class="mood-btn" onclick="selectMood('zen')" data-en="Zen" data-el="Διαλογισμός">
                <i class="fas fa-spa"></i>
                <span>Διαλογισμός</span>
            </button>
            <button class="mood-btn" onclick="selectMood('breakup')" data-en="Break Up" data-el="Χωρισμός">
                <i class="fas fa-heart-broken"></i>
                <span>Χωρισμός</span>
            </button>
        </div>

        <div class="input-area">
            <div class="input-box">
                <input type="text" class="genre-input" 
                    placeholder="Επιλέξτε είδος μουσικής ή αγαπημένο καλλιτέχνη!"
                    data-en="Select music genre or your favorite artist!"
                    data-el="Επιλέξτε είδος μουσικής ή αγαπημένο καλλιτέχνη!">
                <button class="send-btn" onclick="handleCustomGenre()" 
                        data-en="Search" data-el="Αναζήτηση">Αναζήτηση</button>
            </div>
        </div>

        <div id="playlistContainer"></div>

        <div class="footer-note">
            Developed by Costas Chatzisalis © 2025<br>
            Contact: kouroupa82@gmail.com<br>
            <a href="https://ko-fi.com/OrkoMagic" target="_blank">
                <img src="https://cdn.ko-fi.com/cdn/kofi3.png" alt="Support" style="height:40px;">
            </a>
        </div>

        <div class="disclaimer">
            Η εφαρμογή χρησιμοποιεί συνδέσμους Spotify σύμφωνα με τους 
            <a href="https://www.spotify.com/legal/end-user-agreement/" target="_blank">Όρους Χρήσης</a>
        </div>
    </div>

    <script>
        const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        const CLIENT_ID = '6f24397905834a03b7c0e82039d61ca1';
        const REDIRECT_URI = isLocal 
          ? 'http://localhost:5500/callback'  // Σωστή θύρα για Live Server
          : 'https://soundmood-pro-v2.netlify.app/callback';

        let currentLanguage = 'el';
        const playlists = {
            love: { en: "37i9dQZF1DX50QitC6Oqtn", el: "37i9dQZF1DX50QitC6Oqtn" },
            happy: { en: "37i9dQZF1DXdPec7aLTmlC", el: "37i9dQZF1DXdPec7aLTmlC" },
            sad: { en: "37i9dQZF1DX7qK8ma5wgG1", el: "37i9dQZF1DX7qK8ma5wgG1" },
            chill: { en: "37i9dQZF1DX4WYpdgoIcn6", el: "37i9dQZF1DX4WYpdgoIcn6" },
            party: { en: "37i9dQZF1DXaXB8fQg7xif", el: "37i9dQZF1DXaXB8fQg7xif" },
            rainy: { en: "37i9dQZF1DXbvABJXBIyiY", el: "37i9dQZF1DXbvABJXBIyiY" },
            workout: { en: "37i9dQZF1DX76Wlfdnj7AP", el: "37i9dQZF1DX76Wlfdnj7AP" },
            nostalgic: { en: "37i9dQZF1DX4UtSsGT1Sbe", el: "37i9dQZF1DX4UtSsGT1Sbe" },
            zen: { en: "37i9dQZF1DWZqd5JICZI0u", el: "37i9dQZF1DWZqd5JICZI0u" },
            breakup: { en: "37i9dQZF1DXbrUpGvoi3TS", el: "37i9dQZF1DXbrUpGvoi3TS" }
        };

        // ===================== ΑΥΤΕΝΤΙΚΟΠΟΙΗΣΗ =====================
        if(window.location.hash) {
            const hashParams = new URLSearchParams(window.location.hash.substring(1));
            if(hashParams.has('access_token')) {
                localStorage.setItem('spotifyToken', hashParams.get('access_token'));
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        if(!localStorage.getItem('spotifyToken')) {
            const authUrl = `https://accounts.spotify.com/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=streaming%20user-read-email%20user-read-private`;
            window.location.href = authUrl;
        }

        // ===================== PLAYER =====================
        window.onSpotifyWebPlaybackSDKReady = () => {
            const token = localStorage.getItem('spotifyToken');
            if(!token) return;

            const player = new Spotify.Player({
                name: 'SoundMood Pro Player',
                getOAuthToken: cb => cb(token),
                volume: 0.5
            });

            player.addListener('ready', ({ device_id }) => {
                console.log('ΣΥΝΔΕΘΗΚΕ ΗΣΥΣΚΕΥΗ ΜΕ ID:', device_id);
            });

            player.connect();
        };

        // ===================== ΓΛΩΣΣΑ =====================
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'el' ? 'en' : 'el';
            updateTextElements();
        }

        function updateTextElements() {
            document.querySelectorAll('[data-en], [data-el]').forEach(el => {
                const text = el.getAttribute(`data-${currentLanguage}`);
                el[el.tagName === 'INPUT' ? 'placeholder' : 'textContent'] = text;
            });
        }

        // ===================== ΛΕΙΤΟΥΡΓΙΕΣ =====================
        function selectMood(moodType) {
            const playlistId = playlists[moodType][currentLanguage];
            const container = document.getElementById('playlistContainer');
            container.innerHTML = `
                <div class="playlist-card">
                    <iframe src="https://open.spotify.com/embed/playlist/${playlistId}" 
                            width="100%" 
                            height="380" 
                            frameborder="0" 
                            allowtransparency="true" 
                            allow="encrypted-media">
                    </iframe>
                    <div class="social-share">
                        <i class="fab fa-facebook social-icon" onclick="shareTo('facebook', '${playlistId}')"></i>
                        <i class="fab fa-instagram social-icon" onclick="shareTo('instagram', '${playlistId}')"></i>
                        <i class="fab fa-twitter social-icon" onclick="shareTo('twitter', '${playlistId}')"></i>
                    </div>
                </div>
            `;
        }

        async function handleCustomGenre() {
            const input = document.querySelector('.genre-input');
            const searchTerm = input.value.trim();
            
            if(!searchTerm) {
                alert(currentLanguage === 'el' ? "Πληκτρολογήστε κάτι πρώτα!" : "Please type something!");
                return;
            }

            try {
                const response = await fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(searchTerm)}&type=track,artist&limit=5`, {
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('spotifyToken')}` }
                });
                
                const data = await response.json();
                const container = document.getElementById('playlistContainer');
                let html = `<div class="playlist-card"><h3>${currentLanguage === 'el' ? 'Αποτελέσματα για:' : 'Results for:'} ${searchTerm}</h3>`;
                
                data.tracks.items.forEach(track => {
                    html += `
                        <div class="track-item">
                            <iframe src="https://open.spotify.com/embed/track/${track.id}" 
                                   width="100%" 
                                   height="80" 
                                   frameborder="0" 
                                   allowtransparency="true" 
                                   allow="encrypted-media">
                            </iframe>
                            <div class="social-share">
                                <i class="fab fa-facebook social-icon" onclick="shareTo('facebook', '${track.id}')"></i>
                                <i class="fab fa-instagram social-icon" onclick="shareTo('instagram', '${track.id}')"></i>
                                <i class="fab fa-twitter social-icon" onclick="shareTo('twitter', '${track.id}')"></i>
                            </div>
                        </div>`;
                });
                
                container.innerHTML = html + '</div>';
                input.value = '';
            } catch(error) {
                console.error('Search error:', error);
                alert(currentLanguage === 'el' ? "Σφάλμα αναζήτησης" : "Search error");
            }
        }

        function shareTo(platform, contentId) {
            const baseUrl = 'https://open.spotify.com/';
            const url = contentId.length > 22 ? `${baseUrl}track/${contentId}` : `${baseUrl}playlist/${contentId}`;
            
            const shareUrls = {
                facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`,
                instagram: `https://www.instagram.com/?url=${encodeURIComponent(url)}`,
                twitter: `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}`
            };

            window.open(shareUrls[platform], '_blank');
        }

        updateTextElements();
    </script>
    
    <script src="https://sdk.scdn.co/spotify-player.js"></script>
</body>
</html>